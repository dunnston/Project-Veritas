[gd_scene load_steps=14 format=3 uid="uid://bm8k3xpq7n5qr"]

[ext_resource type="Script" path="res://scripts/player/PlayerAnimated3D.gd" id="1_script"]
[ext_resource type="PackedScene" uid="uid://bt5pjynqyinqm" path="res://3d Assets/POLYGON_Prototype_SourceFiles_v4/SourceFiles/Characters/SK_Character_Dummy_Male_01.fbx" id="2_character"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_1"]
radius = 0.3
height = 1.8

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_idle"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_walk"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_run"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jump"]
animation = &"jump"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fall"]
animation = &"fall"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_locomotion"]
blend_point_0/node = SubResource("AnimationNodeAnimation_idle")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_walk")
blend_point_1/pos = 0.5
blend_point_2/node = SubResource("AnimationNodeAnimation_run")
blend_point_2/pos = 1.0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_start_locomotion"]
advance_mode = 3

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_locomotion_jump"]
advance_mode = 2
advance_condition = &"is_jumping"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jump_fall"]
advance_mode = 2
advance_condition = &"is_falling"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fall_locomotion"]
advance_mode = 2
advance_condition = &"is_grounded"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_main"]
states/End/position = Vector2(900, 100)
states/Start/position = Vector2(100, 100)
states/locomotion/node = SubResource("AnimationNodeBlendSpace1D_locomotion")
states/locomotion/position = Vector2(300, 100)
states/jump/node = SubResource("AnimationNodeAnimation_jump")
states/jump/position = Vector2(500, 200)
states/fall/node = SubResource("AnimationNodeAnimation_fall")
states/fall/position = Vector2(700, 200)
transitions = ["Start", "locomotion", SubResource("AnimationNodeStateMachineTransition_start_locomotion"), "locomotion", "jump", SubResource("AnimationNodeStateMachineTransition_locomotion_jump"), "jump", "fall", SubResource("AnimationNodeStateMachineTransition_jump_fall"), "fall", "locomotion", SubResource("AnimationNodeStateMachineTransition_fall_locomotion")]
graph_offset = Vector2(-32, 11)

[node name="PlayerAnimated" type="CharacterBody3D"]
script = ExtResource("1_script")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_1")

[node name="CharacterModel" parent="." instance=ExtResource("2_character")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="AnimationPlayer" type="AnimationPlayer" parent="CharacterModel"]

[node name="AnimationTree" type="AnimationTree" parent="CharacterModel"]
tree_root = SubResource("AnimationNodeStateMachine_main")
anim_player = NodePath("../AnimationPlayer")
active = true
parameters/conditions/is_falling = false
parameters/conditions/is_grounded = false
parameters/conditions/is_jumping = false
parameters/locomotion/blend_position = 0.0

[node name="CameraPivot" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)

[node name="SpringArm3D" type="SpringArm3D" parent="CameraPivot"]
spring_length = 5.0
margin = 0.2

[node name="Camera3D" type="Camera3D" parent="CameraPivot/SpringArm3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 5)
fov = 75.0